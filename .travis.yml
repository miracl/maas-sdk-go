language: go

go:
  - 1.x
  - master

matrix:
  allow_failures:
    - go: master

before_install:
  - go get github.com/mattn/goveralls

before_script:
  - make deps

script:
  - make qa

after_failure:
  - cat ./target/test/report.xml

after_success:
  - if [ "$TRAVIS_GO_VERSION" = "master" ]; then $HOME/gopath/bin/goveralls -covermode=count -coverprofile=target/report/coverage.out -service=travis-ci; fi;
